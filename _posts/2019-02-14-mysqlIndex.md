---
layout:     post
title:      MySql索引
subtitle:   MySQL普通索引和唯一索引如何选择？
date:       2019-02-14
author:     tryingpfq
header-img: img/post-mysql-index.jpg
catalog: true
tags:
    - MySQL
---

## 前言
对于数据库索引，大家应该都不陌生。索引的出现是数据库系统里面最重要的概念之一。

### 创建的索引模型

#### 哈希表
哈希表是一种以键-值存储的数据结构，哈希的思路很简单，对于每个key，都会有一个唯一的hash
值，并把值放在对应位置，当然也通过hash算法后，会发生冲突，就可能在同一个位置上拉出一个
链表。哈希表这种结构适用于只有等值查询的场景。

#### 数组
有序数组在等值查询和范围查询场景中的性能就非常优秀。

#### 二叉搜索树
二叉搜索树也是经典数据结构，以根据身份证查名字为例，每个节点的左儿子小于右儿子，父节点
又小于右儿子，所以这个查询的时间复杂度是O(log(N))。为了维持这个查询的时间复杂度，需要保持
这棵树是平衡二叉树。二叉树是搜索效率最高的，但是实际上大多数的数据存储并不适用二叉树。因为
索引不止存在内存中，还要写到磁盘上。

为了让一个查询尽量少地读磁盘，就必须让查询过程访问尽量少的数据块的大小

### InnoDB 的索引模型
在InnoDB中，表都是根据主键熟悉以索引的形式存放，适用了B+树索引模型。每一个索引在
InnoDB里面对应一棵B+树。主键索引的叶子节点存的是整行数据。在 InnoDB 里，主键索引页被
称为聚簇索引，非主键索引的叶子节点内容是主键的值。在非主键索引也被称为二级索引。

如果是基于主键索引查询，则只需要搜岁ID这棵B+树，如果是基于普通索引查询，需要多扫描一棵
索引树，回到主键索引树搜索的这个过程称为回表。

### 索引如何选择
其实，这两类索引在查询能力上是没差别的，主要考虑的是对性能的影响，所以，一般比较倾向选择
普通索引，普通索引和change buffer的配合使用，对数据量大的表的更新优化还是很明显的

 参考[mysql 45讲](https://time.geekbang.org/column/139)
