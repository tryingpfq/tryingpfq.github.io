---

layout:     post
title:      Redis
subtitle:  	Redis
date:       2020-04-07
author:     tryingpfq
header-img: img/bg-redis.jpg
catalog: true
tags:

    - redis
---



### 安装

[下载](http://download.redis.io/releases/)

tar 解压 

make （make前需要安装Gcc,用yum安装最简单了 yum -y install gcc gcc-c++ kernel-devel //安装gcc、c++编译器以及内核文件）

make test（test 之前需要安装[tcl](https://blog.csdn.net/yanci_/article/details/79959388)）

可以格外创建一个目录用来安装 make redis

make install PREFIX=/usr/data/redis

安装好后，到redis-3.2.8 下拷贝一个文件但redis目录下：cp redis.conf ../redis/redis.conf

安装完后，源码就可以删了



* 启动  要指定conf:   ./redis-server ../redis.conf
* 要在后台运行的话，需要改配置 redis.conf，修改daemonize yes  
* 关闭redis, ./redis-cli shutdown
* 查看 ps -ef|grep redis
* 进入客户端本地  ./redis-cli    ,访问远程  ./redis-cli -h 192.168.146.11 -p 6379





### 基本概念

**多数据库支持**

默认支持16个数据库，可以理解为一个命名空间

跟其他关系型数据库不一样的地方有

1：redis不支持自定义数据库名词

2：每个数据库不能单独设置授权

3：每个数据库之间并不是完全隔离的，可以通过flushall命令清空redis实例面的所有数据库中的数据

可通过 select dbid 去选择不同的数据空命名空间 id范围为 0-15



**基本操作**

1：获取一个符合匹配规则的键名列表

​		keys parttern [? * /]

2：判断一个键是否存在

​		exits key

3：type key 获得这个key的数据结构类型



**各种数据结构的使用**

1：字符类型

​	一个字符类型的key默认存储的最大容量是512M

​	赋值和取值 SET key value     GET key

​	递增数字（原子递增）：incr key   incryby key increment 自定义递增大小

​	原子递减 decr key

​	字符串追加 append key -value

​	获得多个key的value mget key1 key2 key3  同时设置多个key 的value  mset key2 value2 key1 value1

2： 列表类型

​	list:可以存储一个有序的字符串列表

​	lpush/rpush key val......  左右添加数据  lpop/rpop key 取出并移除数据

​	llen key 获得列表长度

​	lrang/rrange key start stop(-1表示最大)  获取区间中的数据

​	lrem key count value 	删除列表值为value 数量为count

​	lset key index value  设置对应索引的值

​	应用场景：**可以用来做分布式队列**

3： 散列类型

​	hash:  key value 形式 不支持数据类型的嵌套

​	比较适合存储对象

​	比如：person:{age,sex,name}

​	hset key filed value , hset person person.age 20  hset person person.name try

​	hget key filed, hget person person.age

​	同样有hset key filed value filed2 value ....,hmget

​	hgetall key,获取hash的所有信息，包括key value

​	hexits key filed  返回 0 1，判断字段是否存在

​	hdel key filed1 filed2.....

4：集合类型

​		set  和 list不同的是，不能存在重复的数据，且有序

​		sadd key member [member....]  增加数据，如果value存在，则会直接覆盖，并返回成功加入后的元素数量

​		srem key member

​		smembers key 获取所有数据 

​		sdiff key1 key2.... 差集运算

​		sunion key1 key2... 并集运算

​		

5：有序集合

​	zadd key score member key2 score memeber (会根据score 排序)

​	zrange key start stop [withscores]  获取元素 



**redis事物**

开启事物：multi  提交事务：exec



**过期时间**

expire key seconds  设置key的过期时间

ttl key 获取剩余超时时间



**发布订阅**

这个应该很少用，用专门的消息中间件实现更好。



**redis实现分布式锁**

